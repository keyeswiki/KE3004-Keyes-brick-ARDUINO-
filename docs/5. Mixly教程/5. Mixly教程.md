# Mixly教程

## 开发环境配置

### **第一小节 安装米思奇软件** 

**1.米思奇（Mixly）软件下载和安装**

打开米思奇软件的官方网站https://mixly.org/explore/software/mixly-arduino，在页面可以看到Mixly2.0最新版和Mixly For的其它版本

![](media/8fd4da3f400364bfd8142264ac385339.png)

点击Mixly2.0版，再点击Mixly2.0 RC网盘文件下载![](media/de136c8dce91784f3d37cb383a997ec1.png)

![](media/09a1bf3f21830bb74d175b41fe2b4830.png)

资料有四个系统版本的软件可以供选择，这里以WIN10-x64版本为例，现在的电脑大部分都是WIN10的系统，点击下载自己所需的软件版本

![](media/53770ed8ce75f845da5588eff5b52dd3.png)

下载好的是米思奇软件的压缩包。压缩包下载好之后，解压到电脑的其中一个硬盘（建议不要放在系统盘），Mixly2.0版本不用安装，解压出来就可以用了

![](media/350f65150915d218b783e9607c329a1f.png)

2.软件的更新

点击软件目录下的一键更新

![](media/2c89566d922d85e0c631a477fc1e48bb.png)

按提示输入“**y**”然后按下Enter键(回车键)即可自动安装，安装完成按下键盘的任意键即可退出

![](media/5016a255aa7678d3f3c8f11bef125891.png)

鼠标右键点击Mixly.exe 发送到电脑桌面，方便日后我们使用。

![](media/834034709efebaa4961bbcb9c27ff190.png)

3.米思奇软件介绍 

米思奇（Mixly）是一个免费的开源图形Arduino编程软件，基于Google的图形化编程框架。它是创意电子开发的免费开源图形编程工具；是完整支持创意电子教育的生态系统；是创客教育者实现梦想的舞台。

安装好了软件，我们点击电脑桌面上的mixly图标来打开软件，选择Arduino AVR

![](media/64100ba26fba67883ca74e4291f22f47.png)

![](media/a5f187be7292f6aeb948b299fd81854a.png)

代码程序上传到Arduino开发板或者兼容板之前，必须先了解米思奇软件工具栏中出现的每个区和接口的功能。

界面布局

介绍面总的分为四大功能区域块。

1.基本功能块区

2.程序构建区

3.代码区

4.信息提示区

![](media/9e20581d54f3761d1df2f50fdf09e728.png)

基本功能块区

输入输出: IO相关功能块

控制: 程序流程控制相关功能块

数学: 数学运算相关功能块

文本: 字符串操作相关功能块

数组: 数组相关功能块

逻辑: 逻辑关系的相关功能块

串口: 串口通信相关功能块

通信: 以太网,红外遥控等通讯功能块

储存: 数据储存相关功能块 (高级视图)

传感器: 通用传感器相关功能块

执行器: 通用执行器相关功能块

显示器: 显示相关功能块

以太网:以太网通讯功能块(高级视图)

变量: 变量操作相关功能块

函数: 函数相关功能块

自定义模块: 自定义代码功能块(高级视图)

程序建构区

该区域为程序功能拼接区域。将功能块从左侧块区拖入程序建构区进行拼接。该区域的右下角有个垃圾桶，可以将不用的代码拖进去删除，也可以将不用的代码直接往最左方拖拽（模块选择区），同样可以删除代码。当然，点击不用的代码后点击键盘
Delete也可将代码删除，还可以右键点击块选择删除块.

![](media/dd43c0a7c6333b1be9d8c3b43f2b98a2.png)

视图缩放

在垃圾桶的上方有两个图形，一个是 ⊕一个是Θ
。该图形可放大或缩小程序构建区模块

的大小。在⊕的上方有一个
按钮，这个按钮的功能是将模块的大小恢复至标准大小，并居中.

![](media/778eeeb838b301bea1f98e55afb5b90f.png)

功能切换

语言切换:在该区域的右上角的设置中，还可以切换语言显示的种类。

主题切换:在设置中主题可以进行普通视图和高级视图来进行视图之间的切换。

编程方式切换：在设置中的代码可以切换编程方式。

撤消/重做:撤销功能是当编写代码时误删模块后，便可以点击左箭头或者直接按
Ctrl+Z 来恢复误删代码；而重做则是和 Ctrl+Z 相反。

![](media/f5e5c7f137939a43d2b64efbf06c081a.png)

文件操作区

新建:新建项目文件

打开:打开项目文件

保存:保存项目文件

另存为:另存项目文件

导出库:导出当前项目为库文件

导入库:导入第三库文件

管理库:库的删除和重命名等操作

![](media/671c6dbfb1ee2d1ec45982e00f5051bd.png)

库文件是为了方便代码分享.将一个功能集成在个函数中。之后导出库
文件.就可以分享给他人使用.

代码区

点击代码可以对当前模块自动生成的代码进行修改，修改后如不切换回图形区,进行编译和下载,将按照修改的代码进行编译或者下载.但如果切换回图形区.代码会恢复为图形区的代码.

![](media/0853e13d11108d809a85ba4b2ebbec18.png)

程序下载及串口监视

编译: 将程序编译为机器执行码.编译过程和结果会在信息显示区显示

上传: 编译程序并上传至主板,上传信息会在信息显示区显示.

主板选择: 选择主板类型及连接的端口

串口监视:
用于监视主板从串口发来的信息或者给主板发送信息.需编程.主要用于调试程序或者显示信息用.

![](media/269b514130f7f9f3f6c7f337c6a0a990.png)**需要注意的是在上传程序时请关闭串口监视窗口.否则会导致程序上传失败**

### 第二小节 安装驱动

（注意：如果电脑已经安装了CH2102驱动程序，则不需要再安装驱动；如果没有，则需要进行以下操作）

**1.Windows上安装驱动** 

![](media/6cf6312dc7c7db27794b54d58a8bf80c.png)

安装Mixly后，我们就开始安装驱动。我们开始为Uno Plus 开发板安装驱动。Uno Plus 开发板的USB转串口芯片用的是著名的CP2102
芯片，这样我们使用起来会非常方便。一般插上USB，电脑就会识别到硬件，WINDOWS就会自动安装CP2102的驱动。![](media/fe2c97ce022a5a071b2530328df74008.png)

如果驱动安装不成功，或者你想手动安装驱动，请打开电脑的设备管理器![](media/5d3921d98a5be791b0b5166164b389e7.png)

显示CP2102的驱动没有安装成功，有一个黄色的感叹号。我们双击硬件更新驱动

![](media/0946d3e3d322e66303a5e3fec0bb53c0.png)

浏览计算机查找驱动程序，找到我们提供的驱动文件目录下的![](media/8e8add384081b25a08c4f65be3885676.png)文件

![](media/abff63e491413339a985a0a03df21106.png)

选择这个dirvers文件夹，然后点击确定，驱动安装成功。

![](media/d8974bc3f232055e84a0f91ebfec9662.png)

![](media/46206568b22edb49565d1cc42635e2fd.png)

这个时候再打开设备管理器，我就可以看到CP2102的驱动程序已经安装成功了，刚刚的那个黄色的感叹号不见了。

![](media/6ec68bee80c913c6ad392c6e7898ed36.png)

**2.在MAC 系统电脑上安装驱动方法** 

![](media/a6fc83596009c574d8e29ef383748549.png)

打开目录下的mac驱动文件夹，双击SiLabsUSBDriverDisk.dmg文件

![](media/085063de72596eed265264de6570a228.jpg)

可以看到以下文件

![](media/3f1afe9499f6d852492cfb9d6b11e9ab.jpg)

双击 Install CP210x VCP Driver ，接着勾上Don’t warn me ，点击Open

![](media/8d7fedad226b17b2444d6ad1c7925577.jpg)

点击Continue

![](media/b1cb125dccf6470ebe255f8f65b902eb.jpg)

继续点击Continue ，然后点击Agree

![](media/865dcc76cb7f58854b56f1020233f05e.jpg)

点击Continue ，然后输入你的用户密码

![](media/1ef6d65b61ad7c6e0a3989ba59de74d5.jpg)

![](media/b4e122b521d3e9301d2b70e00ed504be.jpg)

系统安全问题，需要允许安装，点击 Open Security Preferences

![](media/f97f0c1a960ddda5c2a98f52386f0462.png)

点击安全锁 ，输入你的用户密码来授权

![](media/cb6be428257143635fc4f729487549c5.jpg)

![](media/e8f637a3a9510aa8f90c65820d4d1cd8.jpg)

看到锁被打开了，点击Allow

![](media/250a1cbb7f93fc2a572944bea9fe5494.jpg)

回到安装界面，根据提示等待安装

![](media/62303433d3c44819f9c6d58e6de1f0d3.jpg)

安装成功

![](media/d33ca66538f709ad96ee49a9b585ac7f.jpg)

### 第三小节 导入库文件

打开米思奇软件，点击设置----\>导入库

![](media/d8ffd050e101fa8bd05edffd09fa5078.png)

![](media/3d9d4578bd76ae636944a8b1ef71981d.png)

点击本地导入

![](media/79879a5410a89fd9d587d54c682e7d3b.png)

选择我们文件里提供的Keyestudio文件，这样米思奇库文件就导入完成了。

![](media/4b8654e6f3598688600eec73a24cab68.png)

### 第四小节 启动你的第一个程序

打开我们安装好的Mixly软件选择Arduino AVR进入编程环境

![](media/64100ba26fba67883ca74e4291f22f47.png)

①点击**输入/输出**栏，拖出**数字输出**代码块，放入初始化里面，设置管脚为13（点击![](media/d90df26d789dcaa843c9839eb9a68ea6.png)可选择管脚），电平为高，点亮LED。

![](media/39db33256e5cde23a649e2eae5429515.png)

③在**控制**栏目里拖出延时模块，设置为1000毫秒

![](media/6ba9c689facb986995f492ed3d69c829.png)

④再复制一个**数字输出**代码块，设置管脚为13，电平为低，熄灭LED

![](media/7efa971501b6489344d246f7c06d8e68.png)

⑤再来一个延时1000毫秒

![](media/6ba9c689facb986995f492ed3d69c829.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/7736c229a8bb9008ceefb72b1104f5be.png)

开发板用USB线连接好电脑；上传程序：选择正确串口，波特率是：9600；控制板选择Arduino uno板；然后点击上传程序，程序上传成功会提示上传成功。

![](media/bb3a689e2dcdb745da5316e826a751cf.png)

程序上传成功，板载的LED灯亮一秒钟，灭一秒钟，恭喜你的第一个程序完成了！

![](media/19c8dfd92586ad19678edb962b8f8be7.png)






## 产品安装

安装1

![](media/d4903855e20d5a6f982f9ac90a4f81fb.png)

![](media/4fdb61d276182932caedfa62f7ebd575.png)

![](media/fd4bc3e791ab2f4971a38d31e0beb4f5.png)

安装2

![](media/8761a0a5a90cfb9c073abf84e30bd165.png)

![](media/0fccabbb750d3fe36f7ef7bfc1837c94.png)

![](media/559672aacd3bc96f6a8e6caaaeac24c3.png)

安装3

![](media/c31b2d3867c25b77bb8bcd2e306fc8a9.png)

![](media/9ba56371f1d88e666d92c77060299a7b.png)

![](media/4dbb95603f23e0639074fccadf403114.png)

安装4

![](media/89_1.png)

安装

![](media/89_2.png)

若使用为M1.4*6MM自攻螺丝时，如下图

![](media/100.png)

完成

![](media/89_3.png)

安装5

安装所需零件

![](media/58428c9d987974edfaaab39a8b18ea84.png)

安 装

![](media/89_4.png)

完成

![](media/89_5.png)

将舵机角度调到0度

![](media/7860a7fb2fe9685ead6de6578232d883.png)

如图接好线上传目录下程序

![](media/72574afcf9dd2d23d769847d994f99be.png)

到开发板，舵机自动转动到0度，再进行安装<mark>（注意：这一步很重要）

安装6

安装所需零件

![](media/3f3830f8f82796243dc149c27c9fb1ba.png)

安 装（安装自锁螺母时不可拧紧，安装时窗户为闭合状态如下图所示）

![](media/bb0993d5c2eee787673c9986fcebbcfa.png)

完成

![](media/92f9f949c080cc89f298781be7532e05.jpg)

安装7

安装所需零件

![](media/fd29cb2e81308f691a0579d3c5c7c68f.png)

安装

![](media/40c4fbe0acdfb1ec5e9e32a6a915ce75.png)

完成

![](media/b31168fdd6794e81ca5707ad9cdf7d9e.png)

安装8

安装所需零件

![](media/0b15cc2a0d9f0f13936c2a97e9af18ad.png)

安装

![](media/7f0fa4f189df4857747319585eb94389.png)

完成

![](media/9204f16f9cc903550123e851d1cbd5aa.png)

安装9

安装所需零件

![](media/04ec55e45b6dc6f5140de45e25eb5bc4.png)

安装

![](media/35d3d73f1b6a6c01365fc57f8a3f5b6e.png)

完成

![](media/c61120c702cbf945548572864667258d.png)

安装10

安装所需零件

![](media/5300b5477ec7b8a55263b48a62967c2b.png)

安装

![](media/783b8dbbdc290f151abd72994eba60e6.png)

完成

![](media/ecf4b3efdabfe913bb55e81d045f092b.jpg)

安装11

安装所需零件

![](media/95335e9584578961f0111daf988bf9de.png)

安装

![](media/e82aee91145ff72453bb46538b4dab9b.png)

完成

![](media/862b720f36f280d09311b3ae5c32cdd6.png)

安装12

![](media/aec4d11fefcc0bd0b012da75cc0ec337.png)

安装

![](media/726c4b7d1c495acbf4358ebbdadf9b9e.png)

![](media/b79cc90719d64a8ba36cc28959f955c7.png)

安装13

![](media/8e2d77f1b450f9d3ed146515dea1919c.png)

![](media/9e48e6ff9f03d5d38c9960b4867801e8.png)

![](media/2ce0324018b180f626fb1651ddf0c86d.png)

安装14

![](media/1f00c50cd5f91bcca562de30a821f2f7.png)

安装

![](media/7d6a0b2055d1b25c6a54f4e9cbe26950.png)

![](media/90eb8b2ac6f0e5d793afd66d2cb67e09.png)

安装15

![](media/d0a025c6406bfc84d9a4952a3d61c375.png)

![](media/4bec70766733615f90691e41f9fe5ac5.png)

![](media/d1f07d7c44e1362f7efac79f19501400.png)

安装16

![](media/8c3ad995c343b5345672ceb529ab834b.png)

![](media/1bfb09f5423df7e0d251847b355472f0.png)

完成

![](media/53d9cacb8faf8dff2ed9d7680c98edf2.png)

安装17

安装所需零件

![](media/a31df64dec197768a475d465141e9202.png)

![](media/0d5dcf52a2fbbdea1eb12f05c5a0e848.png)

![](media/419e9c258cf9cb09ad2dded744bdf3df.png)

安装18

![](media/5ddcd1bcdf563792f6f2ebd45395785e.png)

![](media/49a4efde2ec7925161b89feca0953b4e.png)

![](media/281a7427db03c4ccc23e394a378f75a8.png)

安装到此即可开始接线

![](media/60bdd38aecfcdec619c1b4a0a67b1ec9.png)
![](media/5fc90f59511d1cbcf3d64c204b1379e7.png)

![](media/daba34016e16242d627132dc2bb1159e.png)
![](media/f993f2ef1730b12956f9740a574731c5.png)

![](media/9a337dd5a9e23cf1d4779b3b6115d9fb.png)
![](media/23b15cd1418ee9954ab17722ec50cd2d.png)

![](media/e7c5d76594146e2f81b21088ce0b62b1.png)
![](media/f7ef18ef64e086b18acc9c7a638c92dc.png)

![](media/1e47d997a3c4d28cbfe66e6f8e1bbd1b.png)
![](media/39f6de0d37027f94d008b1653dd3cbe6.png)

![](media/0b6d7a165cdcaaa748bba28a5b171b96.png)
![](media/35e64a51b865b10718e24b05436cefc0.png)

![](media/d0c97a12ecc26f514d01eed0c210d64c.png)
![](media/7f45c9a1bce12ba0c8f09492b0a22795.png)

![](media/32ce4b51cdb78c27a407f83a8924c20d.png)
![](media/3294f50ba63e3cea8c48f07d34021b19.png)

![](media/564ba0b0164ef71bde4981fe72849197.png)
![](media/f825eed355494dac90ff9d3d5f0a3a88.png)

![](media/70b3a219ae917623e6e2684332d36bf0.png)
![](media/5c334e9a50a0a46f090e28bbaf465578.png)

![](media/211884fa35ac9f6e9d3b942c5ef1bb24.png)
![](media/92fd3441aa9d9a9c2cb7215907d4547a.png)

![](media/7838738fe32f451c7c83fd0c1d26ec5c.jpg)
![](media/c578509f8562292a7a9c373597abefd4.jpg)
![](media/6dcedb4669bb96a93b385c4d68d57878.png)

模拟气体传感器接线

![](media/35bff37e18054d880be500a9b192056e.png)
![](media/912a6f43ef41bcab06261a302772f488.png)

![](media/75a4621ac71645f54e41000312e7b069.png)

![](media/62cd2703550678df34ef73f02d4635f1.png)

![](media/b94e60e297092a199c0c36af26b50b62.png)

太阳能板接线

![](media/708983877e2b213c72023071500c2e5e.png)

接完线后即可安装最后一步

![](media/b37ac9fa799439697cb1c988b8b1dc22.png)

![](media/82dcbcf5dbda2d78e2ae7f8a24d3a2fa.png)

![](media/cf307e319a130ff616a53d9f29b100e6.png)

## 项目课程

### 第1课LED闪烁

1.1 项目介绍：

前面我们已经组装好了智能家居。接下来的项目我们就要由简单到复杂，一步一步探索Mixly的世界了。LED，即发光二极管的简称。由含镓（Ga）、砷（As）、磷（P）、氮（N）等的[化合物](https://baike.baidu.com/item/%E5%8C%96%E5%90%88%E7%89%A9/1142931)制成。当电子与[空穴](https://baike.baidu.com/item/%E7%A9%BA%E7%A9%B4/3517781)复合时能辐射出可见光，因而可以用来制成发光二极管。在电路及仪器中作为指示灯，或者组成文字或数字显示。砷化镓二极管发红光，磷化镓二极管发绿光，碳化硅二极管发黄光，氮化镓二极管发蓝光。因化学性质又分有机发光二极管OLED和无机发光二极管LED。

为了实验的方便，我们将LED发光二极管做成了一个LED模块，在这个项目中，我们用一个最基本的测试代码来控制LED，亮一秒钟，灭一秒钟，来实现闪烁的效果。你可以改变代码中LED灯亮灭的时间，实现不同的闪烁效果。LED模块信号端S为高电平时LED亮起，S为低电平时LED熄灭。

1.2 模块相关资料：

![](media/98a79cea0b6dae9d2b47785668ed2f9b.png)

|工作电压:|DC 3.3-5V|
|-|-|
|工作电流：|&lt; 20mA|
|最大功率：|0.1W|
|控制接口:|数字口（数字输入）|
|工作温度：|-10°C ~ +50°C|
|LED显示颜色：|黄色|

1.3 实验组件：

|![](media/11f300186a5fe1563643d26a52e29cee.png)|![](media/9a5323418acdfc5911e04dd4ddcd0b1b.jpg)|![](media/5ff79cbf407333d10c51ddeb32401630.png)|![](media/1b75ff37c28a8008ad7c2dbe3408a9df.png)|![](media/45853454e3bc5dd2d4610be37fbbca29.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|LED模块|3P 转杜邦线母*1|

1.4模块接线图：

![](media/1a88b1b5b2f228d4d31484c0c89b5b03.png)

注意：这里体现的是实验使用到的模块接线图，若前面已经组装好智能家居并不用拆掉

1.5 实验程序： 

可以直接打开我们编写好的程序：点击文件下的打开然后找到Mixly教程的第一课程序

![](media/e1ee9fd079489e8b2fb0881d3c23a635.png)

也可以自己通过拖动代码块来编写代码程序，操作步骤如下：

①点击左侧基本块区，在**控制**栏目里面拖出初始化图标![](media/4926b5922c1dcb97e28a1c637369ac15.png)

②点击**输入/输出**栏，拖出**数字输出**代码块，放入初始化里面，设置管脚为5，电平为低，关闭LED。

![](media/9220510bc62d7462feb41f16caca389f.png)

③再单独复制一个**数字输出**代码块，设置管脚为5，电平为高，点亮LED

![](media/0cc74ede37e709cef169b24e916e5b1d.png)

④在**控制**栏目里拖出延时模块，设置为1000毫秒

![](media/6ba9c689facb986995f492ed3d69c829.png)

⑤再复制一个**数字输出**代码块，设置管脚为5，电平为低，熄灭LED

![](media/c6b61259e184353ccfb3a8ebb5ffbd86.png)

⑥再来一个延时1000毫秒

![](media/6ba9c689facb986995f492ed3d69c829.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/619d84038d646648726ef20c4cc4a566.png)

上传程序：选择正确串口，波特率是：9600；控制板选择Arduino uno板；然后点击上传程序，程序上传成功会提示上传成功。

![](media/bb3a689e2dcdb745da5316e826a751cf.png)

1.6实验结果：

将再将船型开关上的“1”端按下，同时黄色LED亮1000毫秒，灭1000毫秒，循环交替。

1.7 代码说明:

|![](media/a79067454d3c8e557834ccb9f106accc.png)|设置引脚5输出高电平|
|-|-|
|![](media/4a446c23b7750bce4cec5dd628754f7c.png)|设置引脚5输出低电平|
|![](media/7f990da3ac0df6ffd3e72f4168490651.png)|延时1000毫秒|

### 第2课 呼吸灯

1.1 项目介绍：

![](media/bbcfcb9ae56abb7e80ee587246fc4be9.gif)前面课程中，我们详细的介绍了通过测试代码控制LED亮灭，实现闪烁的效果。这节课我们使用PWM来控制LED亮度不断地变化，模拟我们呼吸的效果。

PWM是使用数字手段来控制模拟输出的一种手段。使用数字控制产生占空比不同的方波（一个不停在高电平与低电平之间切换的信号)来控制模拟输出。一般来说端口的输出电压只有两个0V与5V。如果想要改变灯的亮度怎么办呢个？有同学说串联电阻，对，这个方法是正确的。但是，如果想要得到不同的亮度，且在不同亮度之间来回变动怎么办呢？不可能不停地切换电阻吧。这种情况下就需要使用PWM了，那它是怎么控制的呢？

对于keyes UNO PLUS开发板的数字端口电压输出只有高与低两个，对应的就是0V与5V的电压输出，可以把低电平定义为0，高电平定义为1，1秒内让keyes UNO PLUS开发板输出500个0或者1的信号。如果这500个全部为1，那就是完整的5V，如果全部为0，那就是0V。如果010101010101这样输出，刚好一半，端口输出的平均电压就为2.5V了。这个和放映电影是一个道理，咱们所看的电影并不是完全连续的，它其实是每秒输出25张图片。在这种情况下，人的肉眼是分辨不出来的，看上去就是连续的了。PWM也是同样的道理，如果想要不同的电压，就控制0与1的输出比例控制就可以了。当然这和真实的连续输出还是有差别的，单位时间内输出的0,1信号越多，控制的就越精确。（输出电压=（开启时间/脉冲时间）\*最大电压值）

在下图中，绿线之间代表一个周期，其值也是PWM频率的倒数。换句话说，如果keyes UNO PLUS开发板的PWM频率是500Hz，那么两绿线之间的周期就是2毫秒。

![](media/553f3d1b6ca04e1aa0479841dd075fa2.png)![](media/25b9663b129fdaa23e1e6ec0a4bd9df0.jpg)

脉冲宽度调制（PWM）有多种应用：灯亮度调节、电机调速、发声等。
以下是PMW的四个基本参数：

![](media/b14db369936f55eef1dd18b050682a10.png)

（1）脉冲宽度的振幅（最小/最大）

（2）脉冲周期（1秒内脉冲频率的倒数）

（3）电压水平（如：0V-5V）

（4）keyes UNO PLUS开发板的PMW接口：D3 D5 D6 D9 D10 D11

1.2 模块相关资料：

![](media/98a79cea0b6dae9d2b47785668ed2f9b.png)

|工作电压:|DC 3.3-5V|
|-|-|
|工作电流：|&lt; 20mA|
|最大功率：|0.1W|
|控制接口:|数字口（数字输入）|
|工作温度：|-10°C ~ +50°C|
|LED显示颜色：|黄色|

1.3 实验组件：

|![](media/11f300186a5fe1563643d26a52e29cee.png)|![](media/c229c49ec658d5e5d4f52d629d74a47f.jpg)|![](media/5ff79cbf407333d10c51ddeb32401630.png)|![](media/205a514d50f8234d4743f86346a2de64.png)|![](media/45853454e3bc5dd2d4610be37fbbca29.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|6812模块|3P 转杜邦线母*1|

1.4模块接线图：

![](media/1a88b1b5b2f228d4d31484c0c89b5b03.png)

注意：这里体现的是实验使用到的模块接线图，若前面已经组装好智能家居并不用拆掉

1.5 实验程序： 

可以直接打开我们编写好的程序：

|文件路径|文件名|
|-|-|
|Mixly教程\3. 项目课程\第2课 呼吸灯\Project_2_PWM|Project_2_PWM.mix|

也可以自己通过拖动代码块来编写代码程序，操作步骤如下：

①初始化D5引脚上的LED为低电平

![](media/0c26d3ea63ac1e1f4b4595b1038f3ce5.png)

③从**控制**栏目里面拖出以下模块，设置i从0到255，步长为1，就执行方块中的命令（代码）

![](media/e757b6ac13a657995f2c5c0d94c031b9.png)

④从**输入/输出**栏目里面拖出模拟输出管脚,设置为5，赋值为变量i

![](media/2b9ee2244c9cb3487b54010b850287a0.png)

⑤拖出一个**延时**模块，时间设置为5毫秒

![](media/d7a095e448bb82ac641f9be796119f8c.png)

⑥从**控制**栏目里面拖出以下模块，设置i从255到0，步长为-1，就执行方块中的命令（代码）

![](media/208b35d42aaac39b256da83768aac588.png)

⑦再拖出一个模拟输出管脚模块，设置为5，并且赋值为变量i

![](media/2b9ee2244c9cb3487b54010b850287a0.png)

⑧再拖出一个**延时**模块，时间设置为5毫秒

![](media/d7a095e448bb82ac641f9be796119f8c.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/eff47cb16a6721b86e7f6c52f1008f69.png)

1.6实验结果：

将再将船型开关上的“1”端按下，黄色LED灯逐渐变暗。然后又逐渐变亮，循环交替，如人体呼吸一样。

1.7 代码说明:

|![](media/731c5ba619aea3b57798d3b2e786291e.png)|i从0到255，每次加1，间隔5ms|
|-|-|
|![](media/4218efd703669521f56bc42f600838e0.png)|i从255到0，每次减1，间隔5ms|

### 第3课 6812RGB彩灯

1.1 项目介绍：

我们这个套价中，还有一个Keyes DIY电子积木 6812 RGB模块，这个SK6812 RGB
模块只需要一个引脚就能控制，这是一个集控制电路与电路于一体的智能外控LED光源。每个LED原件其外型与一个5050LED灯珠相同，每个元件即为一个像点，我们这个模块上有四个灯珠即四个像素，实验中，我们分别使不同的灯亮出不同的颜色。

1.2 模块相关资料：

从原理图中我们可以看出，这四个像素点灯珠都是串联起来的，其实不论多少个，我们都可以用一个引脚控制任一一个灯，并且让它显示任一种颜色。像素点内部包含了智能数字接口数据锁存信号整形放大驱动电路，还包含有高精度的内部振荡器和12V高压可编程定电流控制部分，有效保证了像素点光的颜色高度一致。

数据协议采用单线归零码的通讯方式，像素点在上电复位以后，S端接受从控制器传输过来的数据，首先送过来的24bit数据被第一个像素点提取后，送到像素点内部的数据锁存器。这个6812RGB通讯协议与驱动已经在底层封装好了，我们直接调用函数的接口就可以使用，简单方便，LED具有低电压驱动，环保节能，亮度高，散射角度大，一致性好，超低功率，超长寿命等优点。

![](media/f0d824a10a88aa0fbabfb685634672fc.png)

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/a0a4440f98f604fe19573abb5ad735cf.png)|![](media/0b475062a35179a5895b47951b109e90.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|LED模块|3P 转杜邦线母*1|

1.4模块接线图：

![](media/bc1dac43f55da545bdaf7e4feba6ef4c.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第3课 6812GRB彩灯\Project_3|Project_3_RGB.mix|

这里使用到Mixly库函数，前面若没有导入库函数的，需要添加，添加方法请查看”开发环境配置”。

2.  也可以自己通过拖动代码块来编写代码程序，如下：

寻找代码块

![](media/79d026a6243b112db173a86988fa3e6d.png)

![](media/e8aeb54c07ba89c827f981e8c14b3cb1.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/48ad09fee560529b9c39fda6f48fe253.png)

1.6实验结果：

将再将船型开关上的“1”端按下,按照接线图连接好线，上电后，我们可以看到模块上的四个灯珠分别亮红
绿 蓝 白 色；

1.7 程序说明:

|![](media/807727347b38fe9adf73f3ca8fc91528.png)|接在13号引脚的RGB模块第一位灯珠亮红色|
|-|-|
|![](media/4aaa25aa3833d097d74ee841fa149acb.png)|接在13号引脚的RGB模块第二位灯珠亮绿色|
|![](media/8f37bcf4b3f13a8b57e93f9c00731ad1.png)|接在13号引脚的RGB模块第三位灯珠亮蓝色|
|![](media/767e78359ac40fb96ca3c9c220361da3.png)|接在13号引脚的RGB模块第四位灯珠亮白色|

### 第4课 无源蜂鸣器播放音乐

1.1 项目介绍：

本实验用无源蜂鸣器播放音乐，无源蜂鸣器是通过PWM脉冲宽度调制脉冲进而调节音调，

PWM比较多用于调节LED灯的亮度或者调节无源蜂鸣器的频率，或者是电机的转动速度，电机带动的车轮速度也就能很容易控制了，在玩一些Arduino机器人时，更能体现PWM的好处。

音乐除了要“唱的准”，还要“节奏对”，每一个音符的持续时间，就是节拍啦。我们可以用延时多少来设置节拍的，例如：1拍，1秒即1000毫秒；1/2拍，0.5秒即500毫秒；1/4拍，0.25秒即250毫秒；1/8拍，0.125秒即125毫秒….，我们可以试一试组合不同的音调和节拍，看看会有什么不同的效果。

1.2 模块相关资料：

![](media/1f32014579a6eabb51d23d8ea7cc2812.png)

工作电压：3.3-5V（DC）

电流：50MA

工作温度：-10摄氏度 到 +50摄氏度

尺寸：31.6mmx23.7mm

接口：3PIN接口

输入信号：数字信号（方波）

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/3e05cae18da9549123032b0bd479d866.png)|![](media/0b475062a35179a5895b47951b109e90.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|无源蜂鸣器模块|3P 转杜邦线母*1|

1.4模块接线图：

![](media/61587b0a02eed79dc3c2bf15b5a3df63.png)

1.5 实验程序一 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3.
项目课程\第4课无源蜂鸣器播放音乐\Project4_Buzzer_music|Code1.mix|

2.  也可以自己拖动代码块编写程序：

    **寻找代码块**

    ![](media/bc49edf21559d930772de0dd03cda7af.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/fde34a8b509e77196ec0be570c9258cf.png)

1.6 实验程序二 

可以直接打开我们编写好的程序：

|文件路径|文件名|
|-|-|
|Mixly教程\3.项目课程\第4课无源蜂鸣器播放音乐\Project4_Buzzer_music|Code2.mix|

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/297036d39f7656e055b55685293fb0bb.png)

1.7实验结果：

程序一：上传代码到开发板，蜂鸣器就发出do re mi fa so la si do的声音。

程序二：上传程序到开发板，就会听到无源蜂鸣器先播放“欢乐颂”接着“生日快乐”歌曲；

1.8 代码说明:

在音乐中有两个重要的因素：音调和节拍

![](media/451a3bf12441df8ff7ea201d36beb352.png):表示无源蜂鸣器信号端是接在D3，管脚设置为3，播放音调为NOTE_C4的声音，节拍为1/4拍。音调是由英文和数字组成的音名，选择不同的音名就能改变不同的音调啦。1（Do）、2(Re)、3(Mi)、4(Fa)、5(Sol)、6(La)、7(Si)
是音乐当中的唱名，就对应了音调下拉选项中NOTE_C、NOTE_D、NOTE_E、NOTE_F、NOTE_G、

|1（Do）|2（Re）|3(Mi)|4(Fa)|5(Sol)|6(La)|7(Si)|
|-|-|-|-|-|-|-|
|NOTE_C|NOTE_D|NOTE_E|NOTE_F|NOTE_G|NOTE_A|NOTE_B|

比如

从NOTE_C到NOTE_B，音调是越来越高的；同时把音调改成字母相同时，数字越大，音调越高。

音乐除了要“唱的准”，还要“节奏对”，每一个音符的持续时间，就是节拍，数字越大，持续的时间越长。这里的1拍表示持续时间是1000毫秒，![](media/9280991ebf66dac53c3d692cb6acf2cf.png)1/2拍表示持续时间是500毫秒，3/4拍表示持续时间是750毫秒，1/4拍表示持续时间是250毫秒，依次类推。

![](media/3e77a4a9a0e77dda64f956a232d73afb.jpeg)

### 第5课 太阳能与USB充电锂电池电源模块 

1.实验介绍： 

本模块集成一片充放电芯片，通过PH2.0MM接口可以外接可充电电池，我们使用了单节锂电池。模块有一个micro USB充电口与一个太阳板充电口，通过任意一个口都可以对外接的锂电池进行充电。模块上也集成一个升压模块，可将电池电压升到6.6V。通过3P黄色弯排针G、V脚可以输出6.6V电压，排针的S脚可以读取电阻1/2分压后的电池电压，模块上的拨动开关就是3P弯针6.6V的电压输出开关。

2.模块规格参数： 

|充电接口|Micro USB 与 HP2.0MM太阳能板接口|
|-|-|
|太阳能板接口输入电压|4.4-6V|
|电池恒压充电值|4.15-4.24V|
|最大充电电流|800mA|
|输出接口|3 P 2.54mm 弯针排针|
|输入电压|6.6V|
|最大输出电流|1A|
|外接电池|单节锂电池|
|环保属性|ROHS|

3.模块的原理图 

![](media/189777dcc6b180028d01671c2ea49186.png)

4.模块的简单功能： 

![](media/07e545ee5517782911cb24aac7b87a2d.png)SOLAR4.8-6.0V
端是接太阳能板，太阳能通过太阳能板转化成电能，是电源输入端。

![](media/ca26c0fdc91084511b3d9a948df1fd66.png)BAT端是接电池盒（可充电电池）的，是电源输出端，给电池充电，可将电能储存在电池内。

![](media/252c3ee03fefe739a910924413f1cc62.png)这个拨动开关是电源开关，拨到ON端是接通外接单节锂电池，这样单节锂电池的电压通过模块升压到6.5V从G、V引脚流向Plus
开发板，给开发板供电；反之，拨到OFF端是断开外接单节锂电池的电流。

![](media/92b0c19b4eab104090d92d8c8c7b8391.png)通过microUSB线连接到USB接口和电脑是可以给外接单节锂电池充电的。

### 第6课 按键控灯

1.1 项目介绍：

按键模块按下我们的单片机读取到低电平，松开读取到高电平。在这一实验课程中，我们利用按键和RGB做一个扩展，当按键按下时即读取到低电平时我们点亮RGB灯，松开按键时即读取到高电平时我们熄灭RGB灯，这样就可以通过一个模块控制另一个模块了。

1.2 模块相关资料：

![](media/a51debfc8a38d0d5729d1da394f95ca5.png)附原理图，按键有四个引脚，其中1和3是相连的，2和4是相连的，在我们未按下按键时，13与24是断开的，信号端S读取的是被4.7K的上拉电阻R1所拉高的高电平，而当我们按下按键时，13和24连通。信号端S连接到了GND，此时读取到的电平为低电平，即按下按键，传感器信号端为低电平；松开按键时，信号端为高电平。

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/2f08910a148456221ea40ed2630e5ef2.png)|![](media/0b475062a35179a5895b47951b109e90.png)|![](media/460ac57f07288dccd35285b8f8b2bd6f.png)|![](media/2c5a756c09457d60dedbe7c9e602d011.png)|
|-|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|3P 转杜邦线母*1|RGB灯*1|按键*1|

1.4模块接线图：

![](media/97428e936e34e38603bf4573493c68bc.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|-|-|
|Mixly教程\3. 项目课程\第6课 按键控灯\Project_6_Button|Project_6_Button.mix|

2.  也可以自己拖动代码块编写程序：

寻找代码块

![](media/7fa3b5ad054b296f615d6cb66317c779.png)

![](media/529d096df96a972a485fc8f1f56ca98a.png)![](media/6396651c40d0f4c83b27051e244bb38c.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/8edbbadadb526e1bbef5d7662aa7c1e2.png)

1.6实验结果：

上传测试代码成功，上电后，当我们按下智能家居**⑪号位置**的按键，RGB灯被点亮，松开按键，RGB灯熄灭。

打开串口监视器，波特率设置9600；可以看到按键的电平状态，按键被按下时输出0，未按下输出1；

![](media/fae6cdb618bfb9931757906aa5d6f898.png)

1.7代码说明:

|![](media/6e049b7c236ca3fbba0c89c4909ff876.png)|串口显示按键数据|
|-|-|
|![](media/708df09b8e549f43085863a1810af596.png)|判断语句：如果......否则...... 如果按键被按下执行点亮RGB灯程序 否则执行熄灭RGB灯程序|
|![](media/1681b762897e730d08b92fbcc740ad04.png)|点击蓝色按钮把 否则 拖到 如果下面就得到语句：如果......否则......|

### 第6课 光控灯

1.1 项目介绍：

在这个套件中，有一个Keyes DIY电子积木
光敏电阻传感器，这是一个常用的光敏电阻传感器，它主要采用光敏电阻元件。该电阻元件电阻大小随着光照强度的变化而变化，该传感器就是利用光敏电阻元件这一特性，搭建电路将电阻变化转换为电压变化。光敏电阻传感器可以模拟人对环境光线的强度的判断，可广泛应用于各种光控电路，如对灯光的控制、调节等场合，也可用于光控开关。

实验中，我们将传感器信号端(S端)输入到arduino系列单片机的模拟口，感知模拟值的变化，在串口监视器上显示出对应的模拟值，当小于某个值时点亮LED灯。

1.2 模块相关资料：

![](media/0a804f6b1ccb475325301d7c9c94f38d.png)

|工作电压:|DC 3.3-5V|
|-|-|
|工作电流：|&lt; 20mA|
|最大功率：|0.1W|
|控制接口:|输出信号：模拟信号|
|工作温度：|-10°C ~ +50°C|

原理图分析：当没有亮光时，电阻大小为0.2MΩ，信号端（2点）检测的电压接近0，当随着光照抢度增大，光线传感器的电阻值越来越小，所以信号端检测的电压越来越小。|

1.3 实验组件：

|![](media/d0f550f884a142276ec7c7b2af1a24a6.png)|![](media/d9e1fe718dc1e390674bea8857b5e16a.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/0b475062a35179a5895b47951b109e90.png)|![](media/afab8252a555789a9656cae12d5b3ce3.png)|![](media/a9a7938da6f59aefa989e7f44a1c5afe.png)|
|-|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|3P 转杜邦线母*2|黄色LED模块* 1|Keyes 光敏电阻传感器*1|

1.4模块接线图：

![](media/d1631430706d358a4194440a97ec4770.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第7课 光控灯\Project_7_photocell|Project_7_photocell.mix|

2.  也可以自己拖动代码块编写程序：

寻找代码块

![](media/54de73d9ead4997a308f3d8c82cd3787.png)![](media/e380b2c504e936afd9da282f7bee308f.png)

![](media/fd4ebe694505128c7cc28e7c919b3b05.png)![](media/413db44b8edf2822bcf2762be9f4f630.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/6e9a23beaf5dafdfd7321ae95bba9d35.png)

1.6实验结果：

按照上图接好线，上传好程序，利用USB线上电后，设置波特率为9600，我们看到在串口显示器中打印出光敏传感器测到的值，光敏电阻传感器测到的值小于等于400时，则黄色LED亮；反之，黄色LED不亮。

![](media/fbf6f76f529603fed13a1027772273f8.png)

1.7代码说明:

1.  ![](media/fc1f062fa22e6e9875cf314ddcdc836d.png)这个代码块从指定的模拟引脚A1     读取值。 Arduino 板包含一个多通道、10 位模数转换器。 这意味着它会将
    0 和工作电压（5V 或 3.3V我们这里是5V）之间的输入电压映射为 0 和 1023     之间的整数值。例如，在 Arduino UNO     上，这会产生以下读数之间的分辨率：5 伏/1024 单位即每单位 0.0049 伏
    (4.9 mV)。在基于 ATmega     的板卡（UNO、Nano、Mini、Mega）上，读取模拟输入大约需要 100     微秒（0.0001 s），因此最大读取速率约为每秒 10,000 次。

2.  A1：要读取的模拟输入引脚的名称（大多数板上的A0到A5，我们plus板上的A0到A7，Mega2560上的A0到A15）。函数返回值为引脚上的模拟读数。虽然它受限于模数转换器的分辨率（0-1023     为 10 位或 0-4095 为 12 位）。

### 第8课 小风扇转动

1.1 项目介绍：

130电机控制模块采用HR1124S电机控制芯片。HR1124S是应用于直流电机方案的单通道H桥驱动器芯片。HR1124S的H桥驱动部分采用低导通电阻的PMOS和NMOS功率管。低导通电阻保证芯片低的功率损耗，使得芯片安全工作更长时间。此外HR1124S拥有低待机电流，低静态工作电流，这些性能使HR1124S易用于玩具方案。

该模块兼容各种单片机控制板，如arduino系列单片机。模块上自带的防反插红色端子间距为2.54mm，实验中，我们可通过输出到两个信号端IN+和IN-的电压方向来控制电机的转动方向，让电机转动起来。

1.2 模块相关资料：

|工作电压：|3.3-5V(DC)|最大电流：|200mA (DC5V)|
|-|-|-|-|
|最大功率：|1W|控制接口：|双数字口（数字输入）|
|工作温度：|-10°C ~+50°C|环保属性：|ROHS|

![](media/2498f64be175011ed8b3263749146e4f.png)|

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/800d881ecb0dd004ec0d9695d78fec42.png)|![](media/108172d6f4c8219eb6d9455b9a1aacae.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|Keyes DIY电子积木 130电机模块*1|4P 转杜邦线母*1|

1.4模块接线图：

![](media/d2cd51b65c5d48128d268427f0b8858f.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第8课 小风扇转动\Project_8_Fan|Project_8_Fan.mix|

2.  也可以自己拖动代码块编写程序：

寻找代码块

![](media/ff9ee2a6cb884379e10a66b9c97defab.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/1f67dacc7cf4c948c94c48beb758dc55.png)

1.6实验结果：

烧录好测试程序，打开电源开关后，风扇顺时针转动3秒；停止1秒；逆时针转动3秒；循环交替。

1.7实验扩展：

小风扇转动的速度能不能调？当然能，上传程序”Project_8_Fan2”就可以看到小风扇的转速变慢了，我们只要修改![](media/f3fc6168b6d74037b87329841468eca1.png)的数值就可以改变小风扇的转速了（0~255）;

![](media/a8cedd3adb71035282fe0be756444c7b.png)

1.8代码说明:

将管脚设置为6、7，当6输出为低电平即INA输入低电平，7输出为高电平即INB输入高电平时（输入与输出是相对的，这个实验中对于我们单片机的引脚来说，单片机输出高低电平，自然模块就为输入了，即从单片机输出到模块；例如按键模块则相反，是模块输出到单片机），电机顺时针旋转；当6输出为高电平，7输出为低电平时，电机逆时针旋转；当两个管脚都设置为低电平时，电机停止转动。

### 第9课 控制舵机

1.1 项目介绍：

![](media/69be958142b773acdae33eeef12afed7.png)当我们在制作智能家居时，经常会将舵机和门、窗等固定在一起。这样，我们就可以利用舵机转动，带动门、窗等开或关，从而起到家居生活的智能化功能。在这课程中我们着重介绍下智能家居套件中的舵机的原理和使用方法。

舵机是一种位置伺服的驱动器，主要是由外壳、电路板、无核心马达、齿轮与位置检测器所构成。与马达不同，我们一般控制马达的转速和方向。而舵机更多的是控制指定的角度。常用的舵机可旋转的角度范围是0°到180°。舵机引线为3线，分别用棕、红、橙三种颜色进行区分，舵机品牌和生产厂家不同，会有些许差异，使用之前需查看资料。我们使用的是最常见的舵机，棕、红、橙分别对应“电源负极，电源正极，控制信号”。

1.2 舵机相关资料：

舵机的伺服系统由可变宽度的脉冲来进行控制，橙色的控制线是用来传送脉冲的。一般而言，PWM控制舵机的基准信号周期为20ms（50Hz），理论上脉宽应在1ms到2ms之间，对应控制舵机角度是0°～180°。但是，实际上更多控制舵机的脉宽范围是0.5ms
到2.5ms，具体需要自己实际调试下。

![](media/0982cb7b28f4accde7d378ba812c8bcb.png)

经过实测，舵机的脉冲范围为0.65ms~2.5ms。180度舵机，对应的控制关系是这样的：

|高电平时间|舵机角度|基准信号周期时间（20ms）|
|-|-|-|
|0.65ms|0度|0.65ms高电平+19.35ms低电平|
|1.5ms|90度|1.5ms高电平+18.5ms低电平|
|2.5ms|180度|2.5ms高电平+17.5ms低电平|

舵机的规格参数：

|工作电压：|DC 4.8V〜6V|可操作角度范围：|大约180°(在500→2500μsec)|
|-|-|-|-|
|脉波宽度范围：|500→2500 μsec|外观尺寸：|22.9*12.2*30mm|
|空载转速：|0.12±0.01 sec/60度（DC 4.8V） 0.1±0.01 sec/60度（DC 6V）||
|空载电流：|200±20mA（DC 4.8V） 220±20mA（DC 6V）||
|停止扭力：|1.3±0.01kg·cm（DC 4.8V） 1.5±0.1kg·cm（DC 6V）||
|停止电流：|≦850mA（DC 4.8V） ≦1000mA（DC 6V）||
|待机电流：|3±1mA（DC 4.8V） 4±1mA（DC 6V）||
|重量:|9±1g (without servo horn)||
|使用温度：|-30℃~60℃||

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/b9a9b948b21541e2423daa90ece6dfe6.png)|
|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|180度舵机*1|

1.4模块接线图：

![](media/eb8f2ecef10ac4850dedd5b18e27cb14.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第9课 控制舵机\code|Project_9_Servo1.mix|

也可以自己拖动代码块编写程序：

寻找代码块

![](media/2f0a5088a6cfc2ac3705fe7e4fda676c.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/1626a7945439d5623e9bfce356111877.png)

1.6实验结果：

上传测试代码成功，外接电源开关打开后，“智能家居的门”由0~90~180度来回转动，停顿时间500ms。

1.7代码说明:

|![](media/99c6f8574614b5eba88a97698190b81e.png)|接在管脚9的舵机转动180度，并延时500mS|

### 第10课 水滴警报

1.1 项目介绍：

![](media/389486699548b77a36f4d16b660b3595.png)这是一个常用的水滴水蒸气传感器。它的原理是通过电路板上裸露的金属花纹区检测水量的大小。水量越多，就会有更多的导线被联通，随着导电的接触面积增大，输出的电压就会逐步上升。除了可以检测水量的大小，它还可以检测空气中的水蒸气。即：水滴传感器是一种模拟传感器，可以作为一个简单的雨水探测器和液位开关。当传感器表面的湿度升高时，输出电压将升高，读取到的模拟值即增大。

该传感器兼容各种单片机控制板，如Arduino系列单片机。实验中，将传感器信号端输入到开发板的模拟口，感知模拟值的变化，并在串口监视器上显示出对应的模拟值，当数值达到某一数值时控制蜂鸣器发声。

1.2 模块相关资料：

![](media/3b0760476232188966281131ba9da7e5.png)

|工作电压：|DC 3.3-5V|
|-|-|
|工作温度范围：|－10℃～＋70℃|
|最大工作电流：|5uA (DC5V，或者当水滴传感器两脚直接短接)|
|控制接口：|模拟输出|

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/3e05cae18da9549123032b0bd479d866.png)|![](media/389486699548b77a36f4d16b660b3595.png)|![](media/0b475062a35179a5895b47951b109e90.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|无源蜂鸣器模块|水滴水蒸气传感器模块*1|3P 转杜邦线母*2|

1.4模块接线图：

![](media/d76aaabc1d6d47760d4bed48e6bdde64.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第10课 水滴警报\Project_10_Steam|Project_10_Steam|

也可以自己拖动代码块编写程序：

寻找代码块

![](media/0a7c51e05a7170aaa4e77c67132274a1.png)![](media/3d74423a91c29921b8fd013babdf8c06.png)![](media/04f68357c734b6650ea7c86d683f736d.png)

![](media/03055149adf0e60e87c9274eeaca0d10.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/594d3d64658fd64993af04c7c32e1329.png)

1.6实验结果：

上传好测试程序，打开Arduino智能家居的电源开关，打开串口显示窗口，设置波特率为9600，我们看到在串口显示器中打印水滴传感器测到的湿度模拟值，传感器表面的湿度升高时，输出电压将升高，读取到的模拟值即增大，当大于700时，无源蜂鸣器发声警报。

![](media/3bcf52a3e2fbc92e136fb831af952b72.png)

1.7 代码说明：

|![](media/1bd0817e9472668aafbbcce294a05c2d.png)|①.......初始化 ②.......波特率设置为9600 ③......声明全局变量item为整型 ④......获取水滴传感器的数据并赋值给item ⑤......串口显示item数值 ⑥......延时500mS ⑦......如果数值大于等于700，无源蜂鸣器发出滴滴声 ⑧......否则停止发声|

### 第11课 人体红外传感器实验

人体红外热释电传感器是一款基于热释电效应的人体热释电红外运动传感器，能检测运动的人体或动物身上发出的红外信号，配合菲涅尔透镜能使传感器探测范围更远更广。它主要采用RE200B-P传感器元件，当附近有人或动物运动时，人体红外热释电传感器能根据检测到的红外线，将红外线信号转化为数字信号并输出一个高电平。它可以应用于多种场合来检测人体的运动。传统的热释电红外传感器体积大，电路复杂，可靠性低。

现在我们推出这款一款新的热释电红外运动传感器，该传感器集成了数字热释电红外传感器和连接管脚。具有灵敏度高、可靠性强、超低功耗，体积小、重量轻，超低电压工作模式和外围电路简单等特点。

1.2 模块相关资料：

![](media/ee515734c07dde5b3e5c06f3916e6b74.png)

|工作电压：|DC 4.5-6.5V|
|-|-|
|最大工作电流：|50MA|
|静态电流:|&lt;50uA|
|控制接口：|数字输出(高电平为3.3V ，低电平0V)|
|控制信号：|数字信号1/0|
|工作温度：|-10 ~ 50 ℃|
|最大探测距离：|4米|
|感应角度：|＜100°锥角|
|触发方式:|L 不可重复触发/H 重复触发|

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/8ac56c538ca2e98083ea5eb62153962b.png)|![](media/c534cfb8208e124fcca590ef2b36b266.png)|![](media/800d881ecb0dd004ec0d9695d78fec42.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|人体红外热释传感器*1|黄色LED模块*1|130电机模块*1|
|![](media/108172d6f4c8219eb6d9455b9a1aacae.png)|![](media/0b475062a35179a5895b47951b109e90.png)|![](media/6c14334b97f965614e1d2130b699d649.png)|||
|4P 转杜邦线母*1|3P 转杜邦线母*2|USB线*1|||

1.4模块接线图：

![](media/8f2278fcf8b5922609ed48b840b7f140.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第10课 水滴警报\Project_10_Steam|Project_10_Steam|

也可以自己拖动代码块编写程序：

寻找代码块

![](media/f2e0c22e59dd73e459214e63a967c845.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/f901b346133f1c92fe5153473ff62079.png)

1.6实验结果：

上传好代码，打开串口监视器，设置波特率为9600，如果人体红外热释电传感器检测到人体在附近运动时，串口监视器上显示数字信号1，同时外接在数字引脚5的黄色LED将亮起，小风扇转起；如果未检测到人体在附近运动时，串口监视器上显示数字信号0，同时外接在数字引脚5的黄色LED不亮，小风扇停止转起。

![](media/d385fee8dc4f3288d802e6e4eb46e4e2.png)

### 第12课 MQ2模拟气体传感器实验

1.1 项目介绍：

![](media/c863ecfd743457d03ae742c4011ef7fb.png)气体传感器（MQ-2）可用于家庭用气体泄漏报警器、工业用可燃气体报警器以及便携式气体检测仪器，适宜于液化气、苯、烷、酒精、氢气、烟雾等的探测，被广泛运用到各种消防报警系统中。故因此，气体传感器（MQ-2）可以准确来说是一个多种气体探测器，同时还具有灵敏度高、响应快、稳定性好、寿命长、驱动电路简单等优点。

气体传感器（MQ-2）检测可燃气体与烟雾的浓度范围是300~10000ppm，对天然气、液化石油气等烟雾有很高的灵敏度，尤其对烷类烟雾更为敏感。在使用之前必须加热一段时间，这样输出的电阻和电压较准确。但是加热电压不宜过高，否则会导致内部的信号线熔断。

模拟气体（MQ-2）传感器属于二氧化锡半导体气敏材料，属于表面离子式N型半导体。处于200~300摄氏度时，二氧化锡吸附空气中的氧，形成氧的负离子吸附，使半导体中的电子密度减少，从而使其电阻值增加。当与空气中可燃气体和烟雾烟雾接触时，如果晶粒间界处的势垒收到烟雾的调至而变化，就会引起表面导电率的变化。利用这一点就可以获得烟雾或可燃气体存在的信息，空气中烟雾或可燃气体的浓度越大，导电率越大，输出电阻越低，则输出的模拟信号就越大。

此外，通过旋转电位器可以调整气体传感器（MQ-2）灵敏度。上电后，传感器上的一个指示灯亮绿灯，并且还可以调节蓝色的正方体电位器，使模块上另一个指示灯介于不亮与亮之间的临界点时，灵敏度最高。

1.2 模块相关资料：

![](media/42a27e658a946a1d9845c5846db4b412.png)

|工作电压：|5V|
|-|-|
|工作电流：|160mA (DC5V)|
|工作温度：|0°C ~ 40°C|
|控制接口：|数字、模拟输出|
|检测浓度：|300-10000ppm(可燃气体)|
|浓度斜率：|≤0.6(R3000ppm/R1000ppm C3H8)|
|灵敏度：|Rs(in air)/Rs(1000ppm异丁烷)≥5|
|敏感体表面电阻（Rs）|2KΩ-20KΩ(in 2000ppm C3H8 )|

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/c863ecfd743457d03ae742c4011ef7fb.png)|![](media/3e05cae18da9549123032b0bd479d866.png)|![](media/0b475062a35179a5895b47951b109e90.png)|![](media/5728784721ceea6af7bf57d5a3e7fca9.png)|
|-|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|MQ2传感器*1|无源蜂鸣器模块*1|3P 转杜邦线母*1|4P 转杜邦线母*1|

1.4模块接线图：

![](media/06f471524ee878e439f20b16a48fb85c.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|-|-|
|Mixly教程\3. 项目课程\第12课模拟气体（MQ2）传感器实验\Project_12_Gas|Project_12_Gas.mix|

也可以自己拖动代码块编写程序：

寻找代码块

![](media/0a7c51e05a7170aaa4e77c67132274a1.png)

![](media/c46d2b9d75cd64181be7b7866652d936.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/d27e8f6f26a9d904471ee0d1cb683b69.png)

1.6实验结果：

上传好测试程序，打开Arduino智能家居的电源开关，打开串口显示窗口，设置波特率为9600，我们看到在串口显示器中打印MQ2传感器测到可燃性气体的数据，当大于500时无源蜂鸣器发出滴滴的声音(可以用打火机气体测试)；未检测到可燃性气体时，无源蜂鸣器不发出声音。

![](media/bd6fc30e23245657019192a6dbc98ac5.png)

### 第13课 XHT11温湿度传感器

1.1 项目介绍：

![](media/b6a80d0bcb968495fa23c322ad305cbc.png)XHT11温湿度传感器（XHT11完全兼容DHT11）是一款含有已校准数字信号输出的温湿度复合传感器，其精度：湿度±5%RH，
温度±2℃；量程：湿度20-90%RH，
温度0~50℃。XHT11温湿度传感器应用专用的数字模块采集技术和温湿度传感技术，确保产品具有极高的可靠性和卓越的长期稳定性。XHT11温湿度传感器包括一个电阻式感湿元件和一个NTC测温元件，非常适用于对精度和实时性要求不高的温湿度测量场合。

XHT11有三个引脚，分别为V，G，和S。S为数据输出的引脚，使用的是串行通讯。

1.2 模块相关资料：

![](media/f09e0e21724d59f74375c2b0c6cffd19.png)

|工作电压：|3.3V-5V（DC）|
|-|-|
|最大工作电流：|50mA|
|最大功率：|0.25W|
|控制接口：|数字双向单总线|
|温度范围：|0-50℃（±2℃）|
|湿度范围：|20-90%RH（±5%RH）|
|工作温度：|-25℃~+60℃|

XHT11温湿度传感器的单总线格式定义：

|名称|单总线格式定义|
|-|-|
|起始信号|微处理器把数据总线（SDA）拉低一段时间至少 18ms（最大不得超过30ms），通知传感器准备数据。|
|响应信号|传感器把数据总线（SDA）拉低 83µs，再接高 87µs以响应主机的起始信号。|
|湿度|湿度高位为湿度整数部分数据，湿度低位为湿度小数部分数据|
|温度|温度高位为温度整数部分数据，温度低位为温度小数部分数据，且温度低位Bit8 为 1 则表示负温度，否则为正温度。|
|校验位|校验位＝湿度高位+湿度低位+温度高位+温度低位|

HT11温湿度传感器数据时序图：

用户主机（MCU）发送一次开始信号后，XHT11
从低功耗模式转换到高速模式，待主机开始信号结束后，XHT11
发送响应信号，送出 40bit 的数据，并触发一次信采集。信号发送如图所示。

![](media/c3038afcfc88d77da5ce9e8facf8ef32.png)

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/b6a80d0bcb968495fa23c322ad305cbc.png)|![](media/0b475062a35179a5895b47951b109e90.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|XHT11传感器*1|3P 转杜邦线母*1|

1.4模块接线图：

![](media/8fddd93551b7565e96944bf2a4e54478.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第13课 XHT11温湿度传感器\Project_13_XHT11|Project_13_XHT11.mix|

也可以自己拖动代码块编写程序：

寻找代码块

![](media/2b0959b08a26d28552dece8bdf8e5cb6.png)

![](media/5f9506f4dc7e43f3562ce85699fe5243.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/54a5219e09860d8c1d263875868f8cd7.png)

1.6实验结果：

上传测试代码成功，利用USB线上电后，打开串口监视器，设置波特率为9600。串口监视器显示当前环境中的温湿度数据，如下图：

![](media/aff8bd40467577bd259afb78fd0473ae.png)

### 第14课 LCD1602显示

1.1 项目介绍：

![](media/08b5cb8ff7fe33229395a4e9b1a5d0db.jpeg)Keyes I2C 1602 LCD模块是可以显示2行，每行16个字符的液晶显示器模块。液晶显示器显示蓝底白字，自带I2C通信模块，使用时只需连接单片机I2C通信接口，大大节约了单片机资源。最初的1602 LCD需要7个IO端口来启动和运行，而Keyes I2C 1602 LCD模块内置Arduino IIC/I2C接口，节省了5个IO端口。和Arduino液晶库文件兼容，用起来很简单。

LCD非常适合打印数据和显示数字。可以显示32个字符(16x2)。在Keyes I2C 1602 LCD模块的背面有一个蓝色的电位器，可以转动电位器来调整对比度。**连接时请注意，LCD的GND和VCC不能接反，否则会损坏LCD。**

1.2 模块相关资料：

|工作电压：|DC5V|I2C地址：|0x27|控制接口：|I2C|
|-|-|-|-|-|-|
|工作电流：|&lt; 130mA|工作环境温度：|0°C ~ 45°C（推荐）|驱动芯片：|PCF8574T|

GND：一个接地的引脚|
VCC：一个连接到+5V电源的引脚|
SDA：一个连接到SDA（或A4）的引脚，用于IIC通信|

SCL：一个连接到SCL（或A5）的引脚，用于IIC通信|
背光（蓝底白字）|
可调对比度|

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/1e1f80aa6fe9ac8e5a20ae9cbbe30363.png)|![](media/108172d6f4c8219eb6d9455b9a1aacae.png)|
|-|-|-|-|
|控制板 * 1|扩展板 * 1|Keyes LCD1602模块* 1|4P 转杜邦线母*1|

1.4模块接线图：

![](media/d468f9879762dd5d9603584cdc62d5c3.png)

1.5 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|-|-|
|Mixly教程\3. 项目课程\第14课 LCD1602显示\Project_14_1602_LCD|Project_14_1602_LCD.mix|

也可以自己拖动代码块编写程序：

寻找代码块

![](media/abb9a98e0fcd00b94381b9b25ab7bb57.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/b3324ee8c1501b2445881921018518d6.png)

1.6实验结果：

上传好程序，打开Arduino
智能家居的电源开关,LED1602显示屏第一行显示keyes；第二行显示Hello,world!

1.7代码说明:

|![](media/57c4ff3b937c07d44e255a808d07551d.png)|LCD IIC地址为0x27|
|-|-|
|![](media/f31173bb191f848ca1265d8391cf34eb.png)|LCD显示内容|

### 第14课 温湿度仪表

1.1 项目介绍：

在冬季时，空气中的湿度很低，就是空气很干燥，再加上寒冷，人体的皮肤就容易过于干燥而裂，所以需要再用加湿器给家里的空气增加湿度，但是怎么知道空气过于干燥了呢？那就需要检测空气湿度的设备。前面我们已经学习了XHT11温湿度传感器和LCD1602显示器，这节课我们就使用这两者结合做一个实验，让温湿度在LCD1602显示，实现温湿度仪表功能。

1.2 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/7a44ab558734e294abfaa6291cc37df2.png)|![](media/0b475062a35179a5895b47951b109e90.png)|
|-|-|-|-|-|
|![](media/e858b94b8e802a65930d9c9f6ec40d56.png)|![](media/108172d6f4c8219eb6d9455b9a1aacae.png)||||
|Keyes LCD1602模块* 1|4P 转杜邦线母*1||||

1.3模块接线图：

![](media/1830df3406ec24bbfeb45e34d9696812.png)

1.4 实验代码： 

（1）可以直接打开我们编写好的程序：

|文件路径|文件名|
|Mixly教程\3. 项目课程\第15课 温湿度仪表\Project_15_XHT11|Project_15_XHT11.mix|

也可以自己拖动代码块编写程序：

寻找代码块（前面介绍过的这里不再重复）

![](media/5faed6239814ad0b3410efb74af7247b.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/7d429a372c6dc7c3c6d7cdbd94b15544.png)

1.5实验结果：

上传好示例程序，打开Arduino
智能家居的电源开关，就可以看到LCD1602显示器第一行显示湿度，第二行显示温度

### 第16课 蓝牙控制LED灯

1.1 项目介绍：

![](media/a01c9ddd786f537b08d7537825595892.png)DX-BT24 5.1蓝牙模块是为智能无线数据传输而打造，采用英国DAILOG公司14531芯片，配置
256Kb 空间，遵循V5.1 BLE蓝牙规范。支持AT
指令，用户可根据需要更改串口波特率、设备名称等参数，使用灵活。本模块支持
UART
接口，并支持蓝牙串口透传，具有成本低、体积小、功耗低、收发灵敏性高等优点，只需配备少许的外围元件就能实现其强大功能。

在实验中，我们默认为把蓝牙模块当做从机，手机当做主机。实验中我们在手机上安装对应的APP，在APP上连接蓝牙模块，然后通过手机APP控制智能家居的各元器件实现相应的功能和效果。为此我们还特别设计了分别支持安卓系统和mac系统的手机APP。

1.2 模块相关资料：

（1）参数

蓝牙协议：Bluetooth Specification V5.1 BLE

工作距离：在开放环境中，实现40m超远距离通讯

工作频率：2.4GHz ISM频段

通信接口：UART

蓝牙认证：符合FCC CE ROHS REACH认证标准

串口参数：9600、8数据位、1停止位、无效位、无流控

电源：5V DC

工作温度：–10至+65摄氏度

（2）应用领域：

DX-BT24 模块同时支持 BT5.1 BLE 协议，可以同具备 BLE 蓝牙功能的 iOS
设备直
接连接，支持后台程序常驻运行。主要用于短距离的数据无线传输领域。避免繁琐的线缆
连接，能直接替代串口线。BT24 模块成功应用领域：

※ 蓝牙无线数据传输； ※ 手机、电脑周边设备； ※ 手持 POS 设备；

※ 医疗设备无线数据传输； ※ 智能家居控制； ※ 蓝牙打印机；

※ 蓝牙遥控玩具； ※ 共享单车；

（3）接口说明：

![](media/cd97cf79ff5cdd5bbd78f4cc960d38e5.png)

①STATE：状态脚

②RX：接收脚

③TX：发送脚

④GND：接地脚

⑤VCC：电源脚

⑥EN：使能脚

1.3 实验组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/142dcbfeca8f44fefb1d384630d9ad6d.png)|![](media/9f4566d7799a10501c2c1b0ecd009d94.png)|![](media/0b475062a35179a5895b47951b109e90.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|LED模块* 1|BT-24蓝牙*1|3P 转杜邦线母*1|

1.4模块接线图：

![](media/9f9e61c57d3e9d080064cc0377cce78c.png)

注：蓝牙对好接口插上去即可

1.5 实验代码： 

可以直接打开我们编写好的程序：

|文件路径|文件名|
|-|-|
|Mixly教程\3. 项目课程\第16课 蓝牙控制LED灯\Project_16_Bluetooth|Project_16_Bluetooth|

也可以自己拖动代码块编写程序：

寻找代码块

（1）communication栏中拖出蓝牙代码块

![](media/d17e5067ce52c19ef5fd808fa746c0d1.png)

(2)**控制**栏中拖出 **如果....执行...**
代码块;点击蓝色图标![](media/17483d0949ea96f59fe2aa9bc0243b06.png)把
否则如果 放到如果下面

![](media/3247a50141d363b95bda28a7093bdcfd.png)![](media/2a9ed7f4cdc694ea32b036227e54b75a.png)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*完整的代码如下\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

![](media/f9e21cf0f0836ed5ab5ed91928f8266c.png)

特别注意：：在上传测试代码时，不能连接蓝牙模块，需要把蓝牙模块取下，否则程序上传不成功。先上传测试代码，成功后再连接蓝牙和蓝牙模块，配对，连接APP。

1.6 APP下载和简介

（1）安卓系统手机蓝牙APP（国内）：

下载链接：![](media/f1ebec09a6a924e66654e11bbf3e8827.png)**http://8.210.52.206/keyes-IoT.apk**

二维码下载：![](media/0f77301388c7eb740852ff9394f6ca39.png)

下载安装后打开![](media/c2c30c626d6a10fd8123780ec5847a5d.png)，出现如下图界面。。

![](media/08274943c4117b4172e281510173f3b2.png)

控制板上传代码成功后，连接蓝牙，上电后，蓝牙模块上LED闪烁。开启手机蓝牙，点击左上角的SCANING按钮，进行蓝牙搜索和连接

![](media/67876fa0baf2bee65b73a704f48532cb.jpeg)

点击连接，蓝牙BT24连接成功，显示如下图，蓝牙模块上的LED变为常亮。

![](media/b621a3eba7dfb555827d1537d8073275.jpeg)

（2）苹果系统手机（平板电脑）APP：

打开App Store。

![](media/eeccf6fd30106842b44464a3dc598f0c.png)

在APP Store上搜索IoT keyes，点击获取，下载安装APP即可。

![](media/3f729e12933a29d62cf24dde64d5c7ea.jpeg)

下载安装后打开![](media/c2c30c626d6a10fd8123780ec5847a5d.png)，出现如下图界面。

![](media/cbdbd5555560fbae02c9d45301bad4b1.png)

点击Connect，再点击BT24就可以连接上蓝牙了,此时蓝牙的红色指示灯为常亮。

![](media/042305634978f9000160dd5d405ed1b2.png)

![](media/0877a90c71dee7d98848adb7c49b59f5.png)

在APP中有16个控制按键，当手机APP成功连接上BT-24蓝牙后，我们按下APP控制按键，每按下一个APP上的按键蓝牙发送一个控制字符，蓝牙模块就能接收到一个对应的控制字符，我们在编程时，根据对应按键控制字符设置智能家居各传感器或模块的对应功能。在这个实验中，我们先测试出16个按键对应的控制字符。

1.7实验结果：

上传好测试程序，如上打开APP连接上蓝牙，点击一下![](media/15a22a9e01afedb33f2f81697b0b5bb9.png)点亮黄色LED灯，再点击一下熄灭LED灯。打开串口监视器，设置波特率为9600。按下手机APP上功能按钮，我们可以看到APP上功能按钮对应的控制字符，如下图：

![](media/ff21bdd6ef1aeef8b73fc8bd7f143bc1.png)

经过测试，我们得出了手机APP上各个按钮对应的控制字符和各个按钮对应的功能，这里我们整理了一个表格如下：**（说明：下图是安卓手机的APP一些操作说明界面（ios的界面基本一样））**

|按钮:![](media/00166855cc0493ef6340ab202f129959.png)|功能：配对连接HM-10蓝牙模块|
|-|-|
|按钮:![](media/ed35b9dcb754d77970e03303a1fa730d.png)|功能：断开蓝牙连接|
|按钮:![](media/0bf4845021f35c8b032ad2970d8fbf23.png)|控制字符：点一下发送 “a”； 再点一下发送“b”。|
|按钮:![](media/8bbee596be00faa43666dbc89fef52ef.png)|控制字符：点一下发送 “c”； 再点一下发送“d”。|
|按钮:![](media/2009acb4732995cc83b7fe0ede2a9998.png)|控制字符：按住发送 “e”； 松开发送“g”。|
|按钮:![](media/f0e6081acc58cfd204f416d60656a493.png)|控制字符：按住发送 “f”； 松开发送“g”。|
|按钮:![](media/fd82561fc16273f0e366af7df0c06ec4.png)|控制字符：点一下发送 “h”； 再点一下发送“S”。|
|按钮:![](media/df457bfb68d5ee93c82bd0a1b8538440.png)|控制字符：点一下发送 “i”； 再点一下发送“S”。|
|按钮:![](media/8220b10511d721d55ce50a8e594cce09.png)|控制字符：点一下发送 “j”； 再点一下发送“S”。|
|按钮:![](media/c6892e6f550052216348cafa20dd705d.png)|控制字符：点一下发送 “k”； 再点一下发送“S”。|
|按钮:![](media/027da5a4bb50c846211290d128a26814.png)|控制字符：点一下发送 “l”； 再点一下发送“m”。|

拖动条: 
![](media/b2c91a6d1b3d2c7725ab5b45b7d75969.png)

控制字符：拖动拖动条松开时发送“t 50#”，字符‘t’表示起始字符；数字50表示舵机1的角度；字符‘#’表示终止字符。
按钮:![](media/29180fb7638890a0ffb098743ff08384.png)|控制字符：点一下发送 “n”； 再点一下发送“o”。
拖动条: 

![](media/9b9b4b0d56f15dd4f3aac08a57dc1dbd.png)

控制字符：拖动拖动条松开时发送“u 34#”，字符‘u’表示起始字符；数字34表示舵机2的角度；字符‘#’表示终止字符。
按钮:![](media/0b9f125d6da42737ff3eae79f5378973.png)|控制字符：点一下发送 “p”； 再点一下发送“q”。
拖动条: 

![](media/6d7cc1b6d61a493f95c2e16a5665a0b7.png)

控制字符：拖动拖动条松开时发送“v 100#”，字符‘v’表示起始字符；数字100表示led2的PWM值；字符‘#’表示终止字符。
按钮:![](media/be23528229ee588283d4e1d5da695d5e.png)|控制字符：点一下发送 “r”； 再点一下发送“s”。
拖动条: 

![](media/c193ca31a4d923a7ea87683aa0002061.png)

控制字符：拖动拖动条松开时发送“w 153#”，字符‘w’表示起始字符；数字153表示小风扇的PWM值；字符‘#’表示终止字符。|

### 第17课 智能家居完整版课程

1.1 项目介绍：

前面已经安装了智能家居套件的结构部分和学习了各传感器和模块的使用方法，在最后这个综合的实验中，我们来实现智能家居的所有功能。

1.2 实验主要组件：

|![](media/303e4a39cefdced11c3e567920b9d933.png)|![](media/c93fe0086737d1930fd347d5c4707a0e.jpeg)|![](media/6c14334b97f965614e1d2130b699d649.png)|![](media/a0a4440f98f604fe19573abb5ad735cf.png)|![](media/2dee4678899291cc1a237c49b7552da3.png)|
|-|-|-|-|-|
|控制板 * 1|扩展板 * 1|USB线*1|LED模块|6812模块|
|![](media/3e05cae18da9549123032b0bd479d866.png)|![](media/a9a7938da6f59aefa989e7f44a1c5afe.png)|![](media/800d881ecb0dd004ec0d9695d78fec42.png)|![](media/b9a9b948b21541e2423daa90ece6dfe6.png)|![](media/0d22bc84dfb9df305550b3c350b56e03.png)|
|无源蜂鸣器模块|Keyes 光敏电阻传感器*1|Keyes130电机模块*1|180度舵机*2|Keyes水滴水蒸气传感器模块*1|
|![](media/8ac56c538ca2e98083ea5eb62153962b.png)|![](media/39c9a78b7fdd871862b85f96f8d1c32b.png)|![](media/7a44ab558734e294abfaa6291cc37df2.png)|![](media/0ca3cb2126968bec4cb55643dc583573.png)|![](media/3878879d9acf81f5df96880df42df587.png)|
|Keyes人体红外热释传感器*1|KeyesMQ2传感器*1|KeyesXHT11传感器*1|Keyes LCD1602模块* 1|BT-24蓝牙*1|
|![](media/2c5a756c09457d60dedbe7c9e602d011.png)|![](media/55b45f3b0696580f708ccb41b978e406.png)|![](media/108172d6f4c8219eb6d9455b9a1aacae.png)|![](media/0b475062a35179a5895b47951b109e90.png)||
|Keyes按键*2|充电模块*1|4P 转杜邦线母若干|3P 转杜邦线母若干*1||

1.3接线图：

![](media/66d47d3e40c96648d5f79e492c9c4f3c.png)

|传感器模块名称|传感器模块引脚与传感器扩展板对应的接线|在椴木板上所处的对应位置|
|-|-|-|
|人体红外传感器模块|G/V/S|G/V/2|⑩|
|无源蜂鸣器模块|G/V/S|G/V/3|⑰|
|按键传感器模块1|G/V/S|G/V/4|⑪|
|黄色LED模块|G/V/S|G/V/5|⑨|
|小风扇模块|GND/VCC/IN+/IN-|G/V/6/7|⑥|
|按键传感器模块2|G/V/S|G/V/8|⑫|
|控制门的舵机1|棕色线/红色线/橙色线|G/V/9|①|
|控制窗的舵机2|棕色线/红色线/橙色线|G/V/10|⑲|
|MQ-2烟雾传感器模块|GND/VCC/D0/A0|G/V/11/A0|⑭|
|XHT11模块|G/V/S|G/V/12|⑤|
|GRB灯模块|G/V/S|G/V/13|②|
|LCD1602显示屏模块|GND/VCC/SDA/SCL|GND/5V/SDA/SCL|⑧|
|光敏传感器模块|G/V/S|G/V/A1|⑥|
|水蒸气传感器模块|G/V/S|G/V/A2|④|
|BT-24蓝牙模块|5V/G/RX/TX|VCC/GND/TX/RX||

1.4 流程图 

![](media/e81eee565abc8df128f26674e71c5e9b.png)

1.5 实验程序： 

由于程序比较大，这里就不贴出来了，请打开我们提供的程序查看。

程序目录:

|文件路径|文件名|
|-|-|
|Mixly教程\3. 项目课程\第17课 智能家居\Project_17_Smart_home|Project _17_Smart Home.mix|

1.6代码说明:

（1）在上传代码时，不能连接蓝牙模块，需要把蓝牙模块取下，否则整个程序代码上传不成功。

上传测试代码成功后再插上蓝牙模块，配对，连接APP。

（2）APP的下载和使用参考**第16课**

1.7实验结果：

组装好智能家居，上传好上面的实验程序，太阳能电源板的开关拨到ON位置，按下船型开关的1,打开手机APP连接好蓝牙，按下APP的功能按键就可以控制智能家居了，功能如下：

（1）

|按钮:![](media/00166855cc0493ef6340ab202f129959.png)|功能：配对连接BT-24蓝牙模块||
|-|-|-|
|按钮:![](media/ed35b9dcb754d77970e03303a1fa730d.png)|功能：断开蓝牙连接||
|按钮:![](media/0bf4845021f35c8b032ad2970d8fbf23.png)|控制字符：点一下发送 “a”； 再点一下发送“b”。|功能：点一下，开启门前的RGB灯；再点一下，关闭门前的RGB灯。|
|按钮:![](media/8bbee596be00faa43666dbc89fef52ef.png)|控制字符：点一下发送 “c”； 再点一下发送“d”。|功能：点一下，LCD屏显示温湿度； 再点一下，进入输入密码开锁模式。|
|按钮:![](media/2009acb4732995cc83b7fe0ede2a9998.png)|控制字符：按住发送 “e”； 松开发送“g”。|功能：点一下，播放一次生日快乐歌曲。|
|按钮:![](media/f0e6081acc58cfd204f416d60656a493.png)|控制字符：按住发送 “f”； 松开发送“g”。|功能：点一下，播放一首欢乐颂音乐|
|按钮:![](media/fd82561fc16273f0e366af7df0c06ec4.png)|控制字符：点一下发送 “h”； 再点一下发送“S”。|功能：点一下，开始接收光敏传感器检测到的数据，light处显示检测到的数据； 再点一下，关闭光敏传感器。|
|按钮:![](media/df457bfb68d5ee93c82bd0a1b8538440.png)|控制字符：点一下发送 “i”； 再点一下发送“S”。|功能：点一下，开始接收气体传感器检测到的数据，gas处显示检测到的数据； 再点一下，关闭气体传感器。|
|按钮:![](media/8220b10511d721d55ce50a8e594cce09.png)|控制字符：点一下发送 “j”； 再点一下发送“S”。|这里没有功能，可自行扩展其他其他传感器|
|按钮:![](media/c6892e6f550052216348cafa20dd705d.png)|控制字符：点一下发送 “k”； 再点一下发送“S”。|功能：点一下，开始接收水蒸气传感器检测到的数据，water处显示检测到的数据； 再点一下，关闭水蒸气传感器。|
|按钮:![](media/027da5a4bb50c846211290d128a26814.png)|控制字符：点一下发送 “l”； 再点一下发送“m”。|功能：点一下，开启门； 再点一下，关闭门。|

拖动条: 

![](media/b2c91a6d1b3d2c7725ab5b45b7d75969.png)

控制字符：拖动拖动条松开时发送“t 50#”，字符‘t’表示起始字符；数字50表示舵机1的角度；字符‘#’表示终止字符。|功能：拖动条，控制门的转动大小，就是控制舵机1的角度，door处显示拖动条对应的值。|
按钮:![](media/29180fb7638890a0ffb098743ff08384.png)
控制字符：点一下发送 “n”； 再点一下发送“o”。
功能：点一下，开启窗户； 再点一下，关闭窗户。
拖动条: 

![](media/9b9b4b0d56f15dd4f3aac08a57dc1dbd.png)

控制字符：拖动拖动条松开时发送“u 34#”，字符‘u’表示起始字符；数字34表示舵机2的角度；字符‘#’表示终止字符。|功能：拖动条，控制窗户的转动大小，就是控制舵机2的角度，win处显示拖动条对应的值。|
按钮:![](media/0b9f125d6da42737ff3eae79f5378973.png)
控制字符：点一下发送 “p”； 再点一下发送“q”。
功能：点一下，开启室内LED； 再点一下，关闭室内LED。
拖动条: 

![](media/6d7cc1b6d61a493f95c2e16a5665a0b7.png)

控制字符：拖动拖动条松开时发送“v 100#”，字符‘v’表示起始字符；数字100表示led2的PWM值；字符‘#’表示终止字符。|功能：拖动条，控制室内LED的亮度，led2处显示拖动条对应的PWM值。
按钮:![](media/be23528229ee588283d4e1d5da695d5e.png)
控制字符：点一下发送 “r”； 再点一下发送“s”。
功能：点一下，开启小风扇； 再点一下，关闭小风扇。
拖动条: 

![](media/c193ca31a4d923a7ea87683aa0002061.png)

控制字符：拖动拖动条松开时发送“w 153#”，字符‘w’表示起始字符；数字153表示小风扇的PWM值；字符‘#’表示终止字符。
功能：拖动条，控制小风扇的转速，fans处显示拖动条对应的PWM值。

2.  煤气警报：当MQ2气体传感器检测到煤气泄漏时（数值\>700，这里可以用打火机气体测试）,蜂鸣器发声警报，小于100时停止发声。

3.  下雨关窗：当水滴滴传感器检测数据大于800时，接在引脚10的舵机转动120度关窗，否则转到零度。

4.  天黑开灯：当光敏传感器检测数据小于300并且人体红外传感器检测到有人时，RGB灯亮红色；否则熄灭RGB灯（注：数据小于300的条件下）。

5.  输入密码开门：门上有1602LCD显示屏、两个按钮、舵机1，按按钮1输入密码，正确密码是:
    **. - - . - .**

**(”.”的意思是点击按钮，” -”的意思是长按按钮2S以上)**输入一位显示屏就显示一个“\*”
号，密码输入完成，按下按钮2，如果密码正确，显示屏显示open，舵机1转到100度，开门，5秒之后，人体红外传感器检测到没人时就会自动关门。如果密码错误，显示屏显示error，两秒后显示again之后可重新输入密码。还可以长按，按钮2，蜂鸣器会响，相当于门铃。

